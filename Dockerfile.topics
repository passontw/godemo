FROM golang:1.24-alpine AS builder

WORKDIR /app

# 複製 go.mod 和 go.sum
COPY go.mod go.sum ./

# 下載依賴
RUN go mod download

# 複製源代碼
COPY create-topics.go ./

# 構建應用
RUN GOOS=linux GOARCH=amd64 go build -o create-topics create-topics.go

# 運行階段
FROM alpine:latest

RUN apk --no-cache add ca-certificates

WORKDIR /root/

# 複製構建好的二進制文件
COPY --from=builder /app/create-topics .

# 設置執行權限
RUN chmod +x create-topics

# 設置默認命令
CMD ["./create-topics"] 